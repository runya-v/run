set(LAYOUT_PARSER "layout_parser")

add_library(${LAYOUT_PARSER} SHARED ${MAIN_SRC_DIR}/Plugin.cpp Tree.hpp TagCreator.cpp LayoutParser.cpp)

include_directories("/usr/local/include/htmlcxx")
target_link_libraries(${LAYOUT_PARSER} htmlcxx ${Boost_FILESYSTEM_LIBRARY} ${Boost_PROGRAM_OPTIONS_LIBRARY})

set(LAYOUT_PARSER_DIR "${CMAKE_RUNTIME_OUTPUT_DIRECTORY}/${LAYOUT_PARSER}")

add_custom_command(
    TARGET ${LAYOUT_PARSER} POST_BUILD
    COMMAND bash -c "if [ -d ${LAYOUT_PARSER_DIR} ]\; then rm -r ${LAYOUT_PARSER_DIR}\; fi\; mkdir ${LAYOUT_PARSER_DIR}"
    COMMAND cp "${MAIN_SRC_DIR}/run.sh" "${LAYOUT_PARSER_DIR}.sh"
    COMMAND cp "${CMAKE_RUNTIME_OUTPUT_DIRECTORY}/run" "${LAYOUT_PARSER_DIR}"
    COMMAND cp "${CMAKE_LIBRARY_OUTPUT_DIRECTORY}/lib${LAYOUT_PARSER}.so" "${LAYOUT_PARSER_DIR}"
    )
